# 22-10-05

## Lecture_Note_03

### 7
디스크 디바이스 드라이버의
- 섹터들을 논리적으로 연속된 디스크 블럭(4kB)의 집합으로 추상화

### 8
파일 시스템
- 여러 디스크 블럭들을 하나의 파일로 추상화
- 10kB의 파일을 저장하기 위해선 블럭 3개 필요
- 블럭을 연속적(할당에 오래걸림, 저장 후엔 빠른 액세스 가능)으로 할당할지 남는 공간에 불연속적으로 할당(빨리 할당 가능, 액세스가 느림)할지 선택해야함
- 연속 할당을 쉬워 보이면 하지만 일반적으로 불연속으로 할당
offset
- 파일 중간
- 파일을 읽고 있는 위치를 나타낸다

### 9
inode
- 파일의 메타데이터 관리
- 디스크에 존재

### 10
i모드 
- 처음 4bit는 파일 타입
- 개인, 그룹, 아더스에 대한 읽기, 쓰기, 실행 권한
- u는 셋 유저 아이디 g는 셋 그룹 아이디 
- s는 스티키
다이렉트 블럭
- 디스크 블럭
- 12개 존개 -> 총 48kB
싱글 인다이렉트 블럭
- 디스크 블럭 포인터들로 이루어진 디스크 블럭
- 포인터는 4바이트
- 디스크블럭은 4kB이므로 1k개의 디스크 블럭 가리킬 수 있다 ->  총 4MB
더블 인다이렉트 블럭
- 싱글 인다이렉트 블럭 포인터들로 이루어진 디스크 블럭
- 1k개를 가리킬 수 있다 -> 4GB
트리블 인다이렉트 블럭
- 4TB
범위 넘어가면
- inode에 저장 못함
- 다른 기법 사용
- ext4의 기본적인 inode는 위의 용량이 한계
다이렉트 블럭의 필요성
- 커널이 많드는 수많은 파일 중 48kB를 넘지 않는 경우가 많음
- 48kB넘어가면 인다이렉트 블럭 사용
- 사용하지 않으면 null로 채움

### 11
오타 locations: 10 -> 13
아이노드는 실제로 디스크 블럭에 하나만 저장하지 않는다

### 12
시스템 콜
- 파일에 접근하기 위해 사용하는 운영체제의 인터페이스

### 13
파일 디스크립터
- 한번 열렸던 파일은 파일 디스크립터에 번호로 등록됨
- 파일에 해당하는 inode를 가져옴 -> 파일을 관리하기 위한 모든 정보를 가져올 수 있다

### 14
계층 구조로 추상화
아래 계층을 몰라도 된다

### 15
c언어
- 유닉스 시스템을 만들기 위해 만들어짐
- 과제는 c언어로 작성
vim 사용 -> 터미널 환경에 익숙해야 한다
과제시 주석으로 예제 코드와 같이 정보 표시 필수 -> 없으면 감점 요인
예러 처리 코드 작성
unistd 포직스
funtl 파일디스크립터 관리
errno 리눅스 커널 관련 에러
MAX_BUF 최대 버퍼 크기
0_RDONLY 읽기 전용
fd가 음수면 오픈 실패
리드의 리턴 값 -> 얼만큼 읽었냐, 음수면 리드 실패

### 16
패스네임
- 파일이름, 경로
어팬드 플래그
- 처음 offset이 0이 아니라 끝
논블락 플래그
- 작업 중단
싱크 플래그
- 동기화
- 데이터를 맞추는 것
- e.g. 카톡 채팅이 핸드폰과 PC가 일치
- 메모리는 휘발성이므로 중요한 데이터가 날아갈 수 있다 -> 메모리에서 수정이 이루어지면 바로 디스크로 내린다 -> 메모리와 디스크의 데이터를 일치 시키는 것
액세스 모드
- 파일의 권한 설정
파일이 끝난지 어떻게 알지?
- 리드 사이즈 기준
- 다음에 읽었을 때 0 -> 파일 끝

### 17
숫자 2
- 커널에서 정의한 에러 넘버 중 하나
- 파일이나 디렉토리가 없다

### 18
fd의 번호
- 3부터 시작
- 3이전 값은 이미 설정됨 커널에서
- STDOUT_FINENO는 터미널로 출력

### 19
printf
- 파일디스크립터 1번에 write을 할 것이다

### 20
cat 구현
- 파일 크기가 얼마나 될지 모른다 -> 리드와 라이트를 반복
- 어떤 파일을 읽을건지 인자가 필요 -> main의 인자
- argc는 단어 개수 -> cat file -> 2
- argv[0] = cat, argv[1] = file

### 22
더미데이터
- 가짜 데이터 느낌
리드라이트, 파일 생성, 뉴파일.txt가 있으면 생성 안함
0664
- 권한 설정
- 8진법
- 110110100 : rw-rw-r--
- 7이면 rwx -> 읽고 쓰고 실행 모두 가능
10진법 = 10, 16진법 = a, 8진법 = 12
1, 0x1, 01

### 23
17
- 기존에 파일이 있을 때 나타나는 에러 번호
EXCL를 지우면 다시 만들기 가능
close와 open을 지우면 read는 0
- close를 안하고 fd를 열면 offset이 끝에 있음
- 읽을게 없음
처음에 어팬드
- 리드사이트 18 -> 출력 두번

### 24
offset 움직이는법
- read
- 읽고 싶지 않은 것까지 읽어야 하는 낭비
off_t offset
- 이동하고 시은 offset
whence
- offset을 어떻게 움직일지에 대한 기준
시그셋
- 새로운 오프셋으로 이동
시크cur
- 현재 위치를 오프셋만큼 더해서 이동
시크엔드
- offset을 마지막으로 이동
- 주로 음수를 사용해서 마지막을 기준으로 사용

### 25

### 26
22에 시험, 19 수업 없음
